<main ng-tabs class="c-game-room">

  <header class="c-room__head">
    <div class="room__player">
      <span class="player__indicator">
        Player 1
      </span>
      <span class="player__name">
        {{ roomCtrl.user.name }}
      </span>
    </div>
    <ul class="room__assets">
      <li class="room__asset">
        <img class="c-icon" src="assets/images/money.png" alt="money">
        <span class="c-amount-indicator c-amount-indicator--secondary" count-to="{{roomCtrl.myCoins}}" value="{{roomCtrl.oldCoins}}" duration="2"></span>
      </li>
      <li class="room__asset" ng-repeat="animal in roomCtrl.myBarn">
        <img class="c-icon" src="assets/images/{{animal.assetLink.image}}" alt="{{animal.assetLink.name}}">
        <span class="c-amount-indicator c-amount-indicator--secondary" count-to="{{animal.amount}}" value="{{animal.oldAmount}}" duration="2"></span>
      </li>
    </ul>
  </header>

  <div class="c-room__windows">

    <section class="u-hidden c-window c-window--addons" ng-tab-body="extra-classes">
      Add-ons
    </section>

    <section class="u-hidden c-window c-window--market" ng-tab-body="extra-classes">
      <div ng-tabs class="c-markets">
        <div class="market__currencies u-hidden" ng-tab-body>
          <ul class="c-big-list">
            <li class="c-big-list__item swipable" ng-repeat="animal in roomCtrl.assets"
              ng-swipe-item
              on-left="roomCtrl.sellCurrency(animal)"
              on-right="roomCtrl.buyCurrency(animal)"
              left-template="app/routes/room/partials/buy.html"
              right-template="app/routes/room/partials/sell.html"
              threshold="0.2">
              <div class="c-big-list__icon">
                <img class="c-icon--large" src="assets/images/{{animal.currency.image}}" alt="{{animal.currency.name}}">
              </div>
              <div class="c-big-lig__metadata">
                <h1 class="metadata__title">
                  {{ animal.currency.name }}
                </h1>
                <h2 class="metadata__subtitle">
                    {{((animal.currency.buyFor * (1-animal.currency.sellForPercentage)) + animal.currency.buyFor) / 2 | number : 2}}
                </h2>
                <div class="metadata__info">
                  <span>
                    sell {{ animal.currency.buyFor * (1-animal.currency.sellForPercentage) | number : 2 }}
                  </span>
                  /
                  <span>
                    buy {{ animal.currency.buyFor | number : 2 }}
                  </span>
                </div>
              </div>
            </li>
          </ul>
        </div>
        <div class="market__animals u-hidden" ng-tab-body>
          <ul class="c-big-list">
            <li class="c-big-list__item swipable" ng-repeat="animal in roomCtrl.assets"
              ng-swipe-item
              on-left="roomCtrl.sellAnimal(animal)"
              on-right="roomCtrl.buyAnimal(animal)"
              left-template="app/routes/room/partials/buy.html"
              right-template="app/routes/room/partials/sell.html"
              threshold="0.2">
              <div class="c-big-list__icon">
                <img class="c-icon--large" src="assets/images/{{animal.image}}" alt="{{animal.name}}">
              </div>
              <div class="c-big-lig__metadata">
                <h1 class="metadata__title">
                  {{ animal.name }}
                </h1>
                <h2 class="metadata__subtitle">
                  {{ ((animal.buyFor * (1-animal.sellForPercentage)) + animal.buyFor) / 2 | number : 2}}
                </h2>
                <div class="metadata__info">
                  <span>
                    sell {{ animal.buyFor * (1-animal.sellForPercentage) | number : 2 }}
                  </span>
                  /
                  <span>
                    buy {{ animal.buyFor | number : 2 }}
                  </span>
                </div>
              </div>
            </li>
          </ul>
        </div>
        <div class="c-window__actions">
          <button ng-tab-head="active" class="o-button o-button--accent ripple">
            <i class="material-icons">polymer</i>
            Currencies
          </button>
          <button ng-tab-head class="o-button o-button--accent ripple">
            <i class="material-icons">pets</i>
            Animals
          </button>
        </div>
      </div>

      <!-- <div id="chart"></div> -->

    </section>

    <section class="u-hidden c-window c-window--storage" ng-tab-body="extra-classes">
      <div class="c-storage__header">
        <ul class="c-storage__stats">
          <li class="c-storage__stat">
            <span class="c-amount-indicator c-amount-indicator--primary c-amount-indicator--full">
              fee: 99
            </span>
          </li>
          <li class="c-storage__stat">
            <img class="c-icon" src="assets/images/guard.png" alt="guard">
            <span class="c-amount-indicator c-amount-indicator--primary">
              99
            </span
          </li>
          <li class="c-storage__stat">
            <img class="c-icon" src="assets/images/guard.png" alt="guard">
            <span class="c-amount-indicator c-amount-indicator--primary">
              99
            </span>
          </li>
        </ul>
        <div class="c-turn">
          turn {{ roomCtrl.currentRound }}
          <div class="c-time-left">
            <i class="material-icons">hourglass_empty</i>
            99:00
          </div>
        </div>
      </div>
      <ul class="c-big-list">
        <li class="c-big-list__item" ng-repeat="item in roomCtrl.myStorage">
          <div class="c-big-list__icon">
            <img class="c-icon c-icon--large" src="assets/images/{{item.currencyLink.image}}" alt="{{item.currencyLink.name}}">
          </div>
          <div class="c-big-lig__metadata">
            <h1 class="metadata__title">
              {{ item.currencyLink.name }}
            </h1>
            <h2 class="metadata__subtitle">
              {{ item.amount }}{{ item.currencyLink.measure }}
            </h2>
            <span class="metadata__info">
              {{ item.amount * item.currencyLink.buyFor * (1-item.currencyLink.sellForPercentage) | number : 2 }} coins
            </span>
          </div>
        </li>
      </ul>
      <div class="c-window__actions">
        <button class="o-button o-button--accent-light ripple">
          <i class="material-icons">compare_arrows</i>
          Transfer
        </button>
        <button class="o-button o-button--accent ripple" ng-click="roomCtrl.nextRound()">
          <i class="material-icons">input</i>
          End turn
        </button>
      </div>
    </section>

    <section class="u-hidden c-window c-window--cards" ng-tab-body="extra-classes">
      cards
    </section>

    <section class="u-hidden c-window c-window--vault" ng-tab-body="extra-classes">

      <div class="c-vault__guard">
        <img class="c-icon c-icon--large" src="assets/images/guard.png" alt="guard">
        <div class="guard__text">
          {{ roomCtrl.guardText }}
        </div>
      </div>

      <ol class="c-vault__pincode">
        <li class="c-vault__pincode__number" ng-model="roomCtrl.enteredPin[x]" ng-repeat="x in [0,1,2,3,4]">
          <img class="c-icon c-icon--medium" src="assets/images/{{roomCtrl.enteredPin[x].image }}" alt="{{roomCtrl.enteredPin[x].verbose }}">
        </li>
      </ol>

      <ul class="c-vault__pinnumbers">
        <li ng-click="roomCtrl.addPinNumber(pin)" class="c-vault__pinnumber" ng-repeat="pin in roomCtrl.availablePinNumbers">
          <div class="ripple">
            <img class="c-icon c-icon--big" src="assets/images/{{pin.image}}" alt="{{pin.verbose}}">
          </div>
        </li>
      </ul>

      <div class="c-window__actions">
        <button class="o-button o-button--error ripple" ng-click="roomCtrl.shufflePinNumbers()">
          <i class="material-icons">autorenew</i>
          Reset vault
        </button>
        <button class="o-button o-button--success ripple" ng-click="roomCtrl.enterVault()">
          <i class="material-icons">trending_flat</i>
          Enter vault
        </button>
      </div>

    </section>
  </div>

  <ul class="c-window__tabs">
    <li ng-tab-head class="window__tab ripple">
      <i class="material-icons">queue</i>
      Add-ons
    </li>
    <li ng-tab-head="active" class="window__tab ripple">
      <i class="material-icons">store</i>
      Market
    </li>
    <li ng-tab-head class="window__tab ripple">
      <i class="material-icons">home</i>
      Storage
    </li>
    <li ng-tab-head class="window__tab ripple">
      <i class="material-icons">content_copy</i>
      Cards
    </li>
    <li ng-tab-head class="window__tab ripple" ng-click="roomCtrl.shufflePinNumbers()">
      <i class="material-icons">security</i>
      Vault
    </li>
  </ul>
</main>
